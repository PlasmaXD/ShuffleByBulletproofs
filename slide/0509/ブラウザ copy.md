---

marp: true
title: プライバシー保護付きブラウザアクセス統計収集システム  
description: Count–Min Sketch とローカル差分プライバシの組み合わせ概説
paginate: true
theme: default
header: "CMS × LDP"
footer: "村瀬 淳 | 2025/05/09  "
--------------------------


## 課題: 無数のURLをどう扱うか  
- ウェブ上には無数のURLが存在  
- 事前に全URLをリスト化するのは不可能  
- → 頻度集計のための候補リストが使えない  

---

## 解決策の概要  
1. **行×列の小さな表（CMS Sketch）** を用意  
2. URLごとに対応する「ひとつのセル」だけを＋1カウント  
3. 送信前にランダムノイズ（IRR）を混入してローカル匿名化  
4. 集約後、Sketchから任意URLの訪問頻度を推定可能  

---

## 実験環境とパラメータ検証  
- 数千件のダミー履歴自動生成スクリプト  
- 表の行数×列数、IRRノイズ強度（p, q）を組み合わせ  
- 誤差（MAE, MAPE）がどう変化するか網羅的に評価  

---

## テスト結果ハイライト  
- **Sketchを大きく**すると → 誤差が顕著に減少  
- **ノイズを弱く**すると → プライバシーと精度のバランスが改善  
- パラメータトレードオフの傾向を定量的に把握  

---

## 今後の展開  
1. **証明軽量化**  
   - 入力／出力の合計一致だけに絞る  
2. **自動最適化機構**  
   - Sketchサイズ＆ノイズ量の自動探索  
3. **大規模データ評価**  
   - 数万～数十万件での性能検証  
4. **リアルタイムダッシュボード化**  
   - 集計結果を即時可視化  

---

```mermaid
flowchart TD
  subgraph CMS導入前
    A[ユーザー閲覧履歴収集] --> B[URLリスト生成]
    B --> C{URLはリストに存在？}
    C -->|はい| D[対応セルのカウント増加]
    C -->|いいえ| E[無視 or リスト追加のため手動対応]
    D --> F[集計サーバへ送信]
    E --> F
    F --> G[全URLリストを走査して集計]
    G --> H[結果出力]
  end

  subgraph CMS導入後
    A2[ユーザー閲覧履歴収集] --> B2[CMS Sketch 初期化]
    B2 --> C2[URLをハッシュ → 行×列のセル位置決定]
    C2 --> D2[対応セルのカウント増加]
    D2 --> E2[IRRによるノイズ混入]
    E2 --> F2[Sketchデータを送信]
    F2 --> G2[SketchをAggregate]
    G2 --> H2[estimate_url() で頻度推定]
    H2 --> I2[結果出力]
  end
```
